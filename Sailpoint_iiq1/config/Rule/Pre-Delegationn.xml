<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE Rule PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<Rule language="beanshell" name="Pre-Delegationn" type="CertificationPreDelegation">
  <Description>A pre-delegation rule that is run on every CertificationEntity when the certification is generated in order to cause some entities to be pre-delegated.  As an example, a manager certification could pre-delegate the certification responsibility to each employee that reports to the manager.  This would allow each subordinate to first determine what they need access to, then allow the manager to review their decision.</Description>
  <Signature returnType="Map"/>
  <Source>import sailpoint.object.Identity;


  Map results = new HashMap();
  String currentUser = entity.getIdentity();
  Identity identityObj = context.getObjectByName(Identity.class,currentUser); 
  
  if(identityObj.getName().startsWith("L")){
    System.out.println("Identity Name starts with L "+identityObj.getName() +"; Delegate to N ");
    results.put("recipientName", "Nancy Lee");
    results.put("description", "Nancy Lee delegated items to you to certify access of some users");
    results.put("comments", "This is the access currently granted to user: " + currentUser + ". Please determine whether it is appropriate for job function.");
    return results;
  }else{
    return results;
  }</Source>
</Rule>