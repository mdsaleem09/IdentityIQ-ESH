<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE Rule PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<Rule language="beanshell" name="delete links from applications" type="Validation">
  <Description>This program will return all the objects from Identity Class</Description>
  <Source>

  import sailpoint.object.Filter;

  import sailpoint.object.ManagedAttribute;

  import sailpoint.object.QueryOptions;

  import sailpoint.api.Terminator;
  import sailpoint.object.*;

  QueryOptions qoLinks = new QueryOptions();

  qoLinks.addFilter(Filter.eq("application.name","Active- Directory"));

  Terminator terminator = new Terminator(context);

 // terminator.setTrace(true);

 //return  context.countObjects(Link.class, qoLinks);
  terminator.deleteObjects(Link.class, qoLinks);
  

</Source>
</Rule>