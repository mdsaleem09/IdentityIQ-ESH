<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE Rule PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<Rule language="beanshell" name="sAMA-Account-Generation-2" type="Validation">
  <Description>This program will return all the objects from Identity Class</Description>
  <Source>
  import sailpoint.api.*;
  import sailpoint.object.*;


  Identity id = context.getObjectByName(Identity.class,"Ashley Simpson");
  String firstName=id.getFirstname();
  //String firstName="Teresa";
  String lastName=id.getLastname();
  //return lastName;
  //String lastName="Cole";
  String userName="";
  boolean foundNoUser=true;
  int j=1;

  System.out.println("Entering into  SAMA-Account-NAme Generation");

  public  boolean checkUsername(String name){
    Filter f = Filter.and(Filter.eq("links.test",name),Filter.and(Filter.eq("links.application.name","Active- Directory")));
    QueryOptions qo = new QueryOptions();
    qo.add(f);
    List ids = context.getObjects(Identity.class,qo);
    if(ids.size()&gt;0) return true;
    else return false;
  }

  //#########################  LAST+FIRST  #########################
  while(foundNoUser){
    if(firstName!=null){
      if(lastName.length()&gt;=12){
        for(int i=0;i&lt;12;i++){
          if(i&lt;=firstName.length()) userName=lastName+firstName.substring(0,i);
          if(userName.length()&gt;12) userName=lastName.substring(0,(12-i))+firstName.substring(0,i);   
          if(i&gt;firstName.length()) userName=userName.substring(0,(12-i))+firstName;
          if(!checkUsername(userName)) {
            foundNoUser=false;
            break;
            break;
          }
          else j++;
        }
      }
      else{
        for(int i=0;i&lt;12;i++){
          if(i&lt;=firstName.length()) userName=lastName+firstName.substring(0,i);
          else if(firstName.length()!=lastName.length()) continue;
            if(userName.length()&gt;12) userName=lastName.substring(0,(12-i))+firstName.substring(0,i);   
            if(i&gt;firstName.length()) userName=userName.substring(0,(12-i))+firstName;

            if(!checkUsername(userName)) {
            foundNoUser=false;
            break;
            break;
          }
          else j++;

        }
      }
    }
  }

  //#########################  FIRST+LAST  #########################
  while(foundNoUser){
    if(lastName!=null){
      if(firstName.length()&gt;=12){
        for(int i=0;i&lt;12;i++){
          if(i&lt;=lastName.length()) userName=firstName+lastName.substring(0,i);
          if(userName.length()&gt;12) userName=firstName.substring(0,(12-i))+lastName.substring(0,i); 
          if(i&gt;lastName.length()) userName=userName.substring(0,(12-i))+lastName;
          if(!checkUsername(userName)) {
            foundNoUser=false;
            break;
            break;
          }
          else j++;
        }
      }

      else{
        if(lastName.length()&gt;firstName.length()){
          for(int i=0;i&lt;12;i++){
            if(i&lt;lastName.length()) userName=firstName+lastName.substring(0,i);
            if(userName.length()&gt;12) userName=firstName.substring(0,(12-i))+lastName.substring(0,i);  //new
            if(!checkUsername(userName)) {
              foundNoUser=false;
              break;
              break;
            }
            else j++;
          }
        }


        else if(lastName.length()==firstName.length()){
          for(int i=0;i&lt;12;i++){
            if(i&lt;=lastName.length()) userName=firstName+lastName.substring(0,i);
            if(userName.length()&gt;12) userName=firstName.substring(0,(12-i))+lastName.substring(0,i); 
            if(i&gt;lastName.length()) userName=userName.substring(0,(12-i))+lastName;
            if(!checkUsername(userName)) {
              foundNoUser=false;
              break;
              break;
            }
            else j++;
          }
        }


        else{
          for(int i=0;i&lt;12;i++){
            if(i&lt;lastName.length()) userName=firstName.substring(0,(firstName.length()-i))+lastName.substring(0,i);
            else {
              if(i&lt;=firstName.length()) userName=firstName.substring(0,(firstName.length()-i+1))+lastName;
              else continue;
            }
            if(userName.length()&gt;12) userName=firstName.substring(0,(12-i))+lastName.substring(0,i);

            if(i&gt;lastName.length()) userName=userName.substring(0,(12-i))+lastName;
            if(!checkUsername(userName)) {
              foundNoUser=false;
              break;
              break;
            }
            else j++;
          }
        }
      }

    }
  }


  //#########################  NUMBERS  #########################

  while(foundNoUser){
    if(j&gt;9){
      if(firstName!=null){
        if(lastName.length()&gt;=12){
          for(int i=0;i&lt;(12-(j.toString().length()));i++){
            userName=lastName.substring(0,(11-i))+firstName.substring(0,i)+j.toString();
            if(!checkUsername(userName)) {
              foundNoUser=false;
              break;
              break;
            }
            else j++;
          }
        }
        else{
          for(int i=0;i&lt;(12-j.toString().length());i++){
            if(i&lt;=firstName.length()) userName=lastName+firstName.substring(0,i)+j.toString();
            if(userName.length()&gt;12) userName=lastName.substring(0,(12-(j.toString().length())-i))+firstName.substring(0,i)+j.toString();
            if(i&gt;firstName.length()) userName=userName.substring(0,(12-j.toString().length()-i))+firstName+j.toString();
            if(!checkUsername(userName)) {
              foundNoUser=false;
              break;
              break;
            }
            else j++;
          }
        }
      }


      if(lastName!=null){
        if(firstName.length()&gt;=12){
          for(int i=0;i&lt;(12-(j.toString().length()));i++){
            userName=firstName.substring(0,(11-i))+lastName.substring(0,i)+j.toString();
            if(!checkUsername(userName)) {
              foundNoUser=false;
              break;
              break;
            }
            else j++;
          }
        }
        else{
          for(int i=0;i&lt;(12-j.toString().length());i++){
            if(i&lt;=lastName.length()) userName=firstName+lastName.substring(0,i)+j.toString();
            if(userName.length()&gt;12) userName=firstName.substring(0,(12-(j.toString().length())-i))+lastName.substring(0,i)+j.toString();
            if(i&gt;lastName.length()) userName=userName.substring(0,(12-j.toString().length()-i))+lastName+j.toString();
            if(!checkUsername(userName)) {
              foundNoUser=false;
              break;
              break;
            }
            else j++;
          }
        }
      }
    }


    else{
      if(firstName!=null){
        if(lastName.length()&gt;=12){
          for(int i=0;i&lt;11;i++){
            userName=lastName.substring(0,(12-i))+firstName.substring(0,i)+j.toString();
            if(!checkUsername(userName)) {
              foundNoUser=false;
              break;
              break;
            }
            else j++;
          }
        }
        else{
          for(int i=0;i&lt;=10;i++){
            if(i&lt;=firstName.length()) userName=lastName+firstName.substring(0,i)+j.toString();
            if(userName.length()&gt;12) userName=lastName.substring(0,(11-i))+firstName.substring(0,i)+j.toString();
            if(i&gt;firstName.length()) userName=userName.substring(0,(11-i))+firstName+j.toString();
            if(!checkUsername(userName)) {
              foundNoUser=false;
              break;
              break;
            }
            else j++;
          }
        }
      }
      if(lastName!=null){
        if(firstName.length()&gt;=12){
          for(int i=0;i&lt;11;i++){
            userName=firstName.substring(0,(12-i))+lastName.substring(0,i)+j.toString();
            if(!checkUsername(userName)) {
              foundNoUser=false;
              break;
              break;
            }
            else j++;
          }
        }
        else{
          for(int i=0;i&lt;=10;i++){
            if(i&lt;=lastName.length()) userName=firstName+lastName.substring(0,i)+j.toString();
            if(userName.length()&gt;12) userName=firstName.substring(0,(11-i))+lastName.substring(0,i)+j.toString();
            if(i&gt;lastName.length()) userName=userName.substring(0,(11-i))+lastName+j.toString();
            if(!checkUsername(userName)) {
              foundNoUser=false;
              break;
              break;
            }
            else j++;
          }
        }
      }
    }
  }

  return userName;
  </Source>
</Rule>